import bpy

v = ["2023-05-20 05_25_33.728461", "2023-05-20 05_25_33.990976", "2023-05-20 05_25_34.277979", "2023-05-20 05_25_34.570505", "2023-05-20 05_25_34.885268", "2023-05-20 05_25_35.261883", "2023-05-20 05_25_35.464148", "2023-05-20 05_25_35.660341", "2023-05-20 05_25_36.049677", "2023-05-20 05_25_36.304363", "2023-05-20 05_25_36.475804", "2023-05-20 05_25_36.762993", "2023-05-20 05_25_36.996881", "2023-05-20 05_25_37.226900", "2023-05-20 05_25_37.656595", "2023-05-20 05_25_38.003251", "2023-05-20 05_25_38.220333", "2023-05-20 05_25_38.626637", "2023-05-20 05_25_38.744503", "2023-05-20 05_25_39.312082", "2023-05-20 05_25_39.420011", "2023-05-20 05_25_39.683862", "2023-05-20 05_25_39.854626", "2023-05-20 05_25_40.139628", "2023-05-20 05_25_40.441654", "2023-05-20 05_25_40.703626", "2023-05-20 05_25_41.072585", "2023-05-20 05_25_41.350540", "2023-05-20 05_25_41.880823", "2023-05-20 05_25_42.060660", "2023-05-20 05_25_42.424526", "2023-05-20 05_25_42.657738", "2023-05-20 05_25_42.734155", "2023-05-20 05_25_42.961728", "2023-05-20 05_25_43.643175", "2023-05-20 05_25_43.819311", "2023-05-20 05_25_44.144711", "2023-05-20 05_25_44.713766", "2023-05-20 05_25_45.170035", "2023-05-20 05_25_45.464513", "2023-05-20 05_25_45.983382", "2023-05-20 05_25_46.108044", "2023-05-20 05_25_46.407213", "2023-05-20 05_25_46.555830", "2023-05-20 05_25_46.981860", "2023-05-20 05_25_47.830709", "2023-05-20 05_25_48.000251", "2023-05-20 05_25_48.033928", "2023-05-20 05_25_48.334921", "2023-05-20 05_25_48.701363", "2023-05-20 05_25_49.200496", "2023-05-20 05_25_49.723585", "2023-05-20 05_25_49.968374", "2023-05-20 05_25_50.357765", "2023-05-20 05_25_50.463482", "2023-05-20 05_25_50.963737", "2023-05-20 05_25_52.456489", "2023-05-20 05_25_52.572159", "2023-05-20 05_25_52.799725", "2023-05-20 05_25_53.215555", "2023-05-20 05_25_53.492379", "2023-05-20 05_25_53.935672", "2023-05-20 05_25_54.355061", "2023-05-20 05_25_54.490787", "2023-05-20 05_25_54.833938", "2023-05-20 05_25_55.739694", "2023-05-20 05_25_55.889809", "2023-05-20 05_25_56.160472", "2023-05-20 05_25_56.413501", "2023-05-20 05_25_56.653461", "2023-05-20 05_25_56.977191", "2023-05-20 05_25_57.245284", "2023-05-20 05_25_57.438526", "2023-05-20 05_25_57.633370", "2023-05-20 05_25_57.863104", "2023-05-20 05_25_58.123916", "2023-05-20 05_25_58.352778"]
startPos = 0

for (idx, item) in enumerate(v[startPos:]):
    src=f"C:\\Users\\Tap\\Documents\\OSRS stuff\\OSRS-Environment-Exporter\\output\\{item}\\scene.gltf"
    dst=f"C:\\Users\\Tap\\Documents\\OSRS stuff\\OSRS-Environment-Exporter\\converted\\{item}.fbx"

    displayIdx = f"{idx + startPos + 1}/{len(v)}"

    print(f"[PROGRESS] Pre-flushing {displayIdx}")
    bpy.ops.wm.read_homefile()
    for obj in bpy.data.objects:
        bpy.data.objects.remove(obj)

    print(f"[PROGRESS] Importing {displayIdx}")
    bpy.ops.import_scene.gltf(filepath=src)
    bpy.ops.object.select_all(action='SELECT')

    print(f"[PROGRESS] Exporting {displayIdx}")
    bpy.ops.export_scene.fbx(filepath=dst)
    print("----------------------------------")

print("Done!")
